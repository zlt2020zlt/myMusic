<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前言 | YogurtCat企业开发平台</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/yogurtcat/assets/css/0.styles.e02c7717.css" as="style"><link rel="preload" href="/yogurtcat/assets/js/app.4215de08.js" as="script"><link rel="preload" href="/yogurtcat/assets/js/2.557ba043.js" as="script"><link rel="preload" href="/yogurtcat/assets/js/34.e8875b32.js" as="script"><link rel="prefetch" href="/yogurtcat/assets/js/10.628c373b.js"><link rel="prefetch" href="/yogurtcat/assets/js/11.a76da41c.js"><link rel="prefetch" href="/yogurtcat/assets/js/12.c9941626.js"><link rel="prefetch" href="/yogurtcat/assets/js/13.b9c5cab2.js"><link rel="prefetch" href="/yogurtcat/assets/js/14.5eefe6eb.js"><link rel="prefetch" href="/yogurtcat/assets/js/15.6b426051.js"><link rel="prefetch" href="/yogurtcat/assets/js/16.13b41e0f.js"><link rel="prefetch" href="/yogurtcat/assets/js/17.b18cf953.js"><link rel="prefetch" href="/yogurtcat/assets/js/18.4488d21f.js"><link rel="prefetch" href="/yogurtcat/assets/js/19.26659f1e.js"><link rel="prefetch" href="/yogurtcat/assets/js/20.83aec30d.js"><link rel="prefetch" href="/yogurtcat/assets/js/21.e14ffc77.js"><link rel="prefetch" href="/yogurtcat/assets/js/22.3eef13c6.js"><link rel="prefetch" href="/yogurtcat/assets/js/23.e2fba612.js"><link rel="prefetch" href="/yogurtcat/assets/js/24.f94cc4bf.js"><link rel="prefetch" href="/yogurtcat/assets/js/25.642c540f.js"><link rel="prefetch" href="/yogurtcat/assets/js/26.812c9d1f.js"><link rel="prefetch" href="/yogurtcat/assets/js/27.1a6e67e8.js"><link rel="prefetch" href="/yogurtcat/assets/js/28.c5e9886e.js"><link rel="prefetch" href="/yogurtcat/assets/js/29.43c1cd4e.js"><link rel="prefetch" href="/yogurtcat/assets/js/3.5f9e62d6.js"><link rel="prefetch" href="/yogurtcat/assets/js/30.c9669e4e.js"><link rel="prefetch" href="/yogurtcat/assets/js/31.de14d9c5.js"><link rel="prefetch" href="/yogurtcat/assets/js/32.8baa06c1.js"><link rel="prefetch" href="/yogurtcat/assets/js/33.9ee721c0.js"><link rel="prefetch" href="/yogurtcat/assets/js/35.ffed4c63.js"><link rel="prefetch" href="/yogurtcat/assets/js/36.2f102bf8.js"><link rel="prefetch" href="/yogurtcat/assets/js/37.0be5c675.js"><link rel="prefetch" href="/yogurtcat/assets/js/38.9d6b2808.js"><link rel="prefetch" href="/yogurtcat/assets/js/39.ba9dc4ef.js"><link rel="prefetch" href="/yogurtcat/assets/js/4.c94e21e3.js"><link rel="prefetch" href="/yogurtcat/assets/js/40.3aacfb2f.js"><link rel="prefetch" href="/yogurtcat/assets/js/5.27a54d39.js"><link rel="prefetch" href="/yogurtcat/assets/js/6.5c26f68f.js"><link rel="prefetch" href="/yogurtcat/assets/js/7.0d45f3e9.js"><link rel="prefetch" href="/yogurtcat/assets/js/8.87957c69.js"><link rel="prefetch" href="/yogurtcat/assets/js/9.ed734813.js">
    <link rel="stylesheet" href="/yogurtcat/assets/css/0.styles.e02c7717.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/yogurtcat/" class="home-link router-link-active"><!----> <span class="site-name">YogurtCat企业开发平台</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/yogurtcat/" class="nav-link">主页</a></div><div class="nav-item"><a href="/yogurtcat/specification/overview.html" class="nav-link">开发规范</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开发指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yogurtcat/front/guide/overview.html" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/server/guide/" class="nav-link">服务端</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">功能</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端功能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/front/editor/" class="nav-link">富文本编辑器</a></li></ul></li><li class="dropdown-item"><h4>服务端功能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/server/word/" class="nav-link">word导入导出</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/excel/" class="nav-link">excel导入导出</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/pdf/" class="nav-link">pdf导入导出</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/front/vue/" class="nav-link">vue</a></li><li class="dropdown-subitem"><a href="/yogurtcat/front/vuex/" class="nav-link">vuex</a></li><li class="dropdown-subitem"><a href="/yogurtcat/front/vue-router/" class="nav-link">vue-router</a></li><li class="dropdown-subitem"><a href="/yogurtcat/front/element/" class="nav-link">element</a></li></ul></li><li class="dropdown-item"><h4>服务端框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter/" class="nav-link">spring-boot-starter</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-security/" class="nav-link">spring-boot-starter-security</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-data-jpa/overview.html" class="nav-link router-link-exact-active router-link-active">spring-boot-starter-data-jpa</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-data-elasticsearch/" class="nav-link">spring-boot-starter-data-elasticsearch</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-amqp/" class="nav-link">spring-boot-starter-amqp</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-aop/" class="nav-link">spring-boot-starter-aop</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-logging/" class="nav-link">spring-boot-starter-logging</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-test/" class="nav-link">spring-boot-starter-test</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">中间件指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/nginx/" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/seaweedfs/" class="nav-link">seaweedfs</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/elasticsearch/" class="nav-link">elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/kibana/" class="nav-link">kibana</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/beats/" class="nav-link">beats</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/yogurtcat/" class="nav-link">主页</a></div><div class="nav-item"><a href="/yogurtcat/specification/overview.html" class="nav-link">开发规范</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开发指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yogurtcat/front/guide/overview.html" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/server/guide/" class="nav-link">服务端</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">功能</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端功能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/front/editor/" class="nav-link">富文本编辑器</a></li></ul></li><li class="dropdown-item"><h4>服务端功能</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/server/word/" class="nav-link">word导入导出</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/excel/" class="nav-link">excel导入导出</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/pdf/" class="nav-link">pdf导入导出</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/front/vue/" class="nav-link">vue</a></li><li class="dropdown-subitem"><a href="/yogurtcat/front/vuex/" class="nav-link">vuex</a></li><li class="dropdown-subitem"><a href="/yogurtcat/front/vue-router/" class="nav-link">vue-router</a></li><li class="dropdown-subitem"><a href="/yogurtcat/front/element/" class="nav-link">element</a></li></ul></li><li class="dropdown-item"><h4>服务端框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter/" class="nav-link">spring-boot-starter</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-security/" class="nav-link">spring-boot-starter-security</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-data-jpa/overview.html" class="nav-link router-link-exact-active router-link-active">spring-boot-starter-data-jpa</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-data-elasticsearch/" class="nav-link">spring-boot-starter-data-elasticsearch</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-amqp/" class="nav-link">spring-boot-starter-amqp</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-aop/" class="nav-link">spring-boot-starter-aop</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-logging/" class="nav-link">spring-boot-starter-logging</a></li><li class="dropdown-subitem"><a href="/yogurtcat/server/spring-boot-starter-test/" class="nav-link">spring-boot-starter-test</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">中间件指南</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/nginx/" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/seaweedfs/" class="nav-link">seaweedfs</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/elasticsearch/" class="nav-link">elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/kibana/" class="nav-link">kibana</a></li><li class="dropdown-item"><!----> <a href="/yogurtcat/middleware/beats/" class="nav-link">beats</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>开发规范</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yogurtcat/server/spring-boot-starter-data-jpa/overview.html" class="active sidebar-link">前言</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yogurtcat/server/spring-boot-starter-data-jpa/overview.html#数据保存" class="sidebar-link">数据保存</a></li><li class="sidebar-sub-header"><a href="/yogurtcat/server/spring-boot-starter-data-jpa/overview.html#数据查询" class="sidebar-link">数据查询</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h1> <p>spring data jpa提供了Java persist API支持，简化了访问jpa数据源的功能开发。</p> <ul><li>什么是JPA?<br>
JPA全称Java持久化访问接口定义，它的作用在于统一了持久层框架的行为，消除不同持久层框架操作的差异性。</li></ul> <h1 id="使用指导"><a href="#使用指导" aria-hidden="true" class="header-anchor">#</a> 使用指导</h1> <h2 id="数据保存"><a href="#数据保存" aria-hidden="true" class="header-anchor">#</a> 数据保存</h2> <p>spring data jpa通过CrudRepository.save(…)方法统一了新增和更新的操作。spring data jpa的save是如何区分新增和更新呢，是通过实体的isNew方法，默认情况是通过id值查询实体是否存在，如果存在调用entityManager.merge(…)进行数据更新，如果不存在调用entityManager.persist(…)进行数据新增。</p> <h3 id="使用举例"><a href="#使用举例" aria-hidden="true" class="header-anchor">#</a> 使用举例</h3> <div class="language- extra-class"><pre class="language-text"><code>public interface UserRepository extends Repository&amp;lt;User, Long&amp;gt; {
	
	User save(User user);
}
</code></pre></div><h2 id="数据查询"><a href="#数据查询" aria-hidden="true" class="header-anchor">#</a> 数据查询</h2> <p>spring data jpa数据查询提供了多种方式，这里我们只介绍YogurtCat平台使用的方式。</p> <ul><li>通过方法生成简单查询</li> <li>通过Specifications生产复杂查询</li></ul> <h3 id="通过方法生成简单查询"><a href="#通过方法生成简单查询" aria-hidden="true" class="header-anchor">#</a> 通过方法生成简单查询</h3> <p>方法名查询是spring data jpa提供的一个非常方便的特性。在加载领域对象的时候通过扫描方法名来生成对应的查询语句。<br>
方法名由操作，主题以及断言三个部分组成。例如findUserByLastnameAndFirstname方法，find是操作，User是主题，LastnameAndFirstname是断言。各个部分的作用如下：</p> <ul><li>操作<br>
操作包括find,read,get,query以及count。前面四个操作指的是对象查询，最后的count指的是对象数量的查询。</li> <li>主题<br>
主题就是当前领域对象名，因为可以通过上下文推导，所以主题名一般可以不写。只有一种情况必须写主题那就是与distinct组合去重查询的时候必须携带主题名。</li> <li>断言<br>
断言就是过滤条件，过来查询结果。</li></ul> <h4 id="断言关键字及等价的效果见下表"><a href="#断言关键字及等价的效果见下表" aria-hidden="true" class="header-anchor">#</a> 断言关键字及等价的效果见下表</h4> <table><thead><tr><th>关键词</th> <th style="text-align:left;">示例</th> <th style="text-align:right;">等价效果</th></tr></thead> <tbody><tr><td>And</td> <td style="text-align:left;">findByLastnameAndFirstname</td> <td style="text-align:right;">… where x.lastname = ?1 and x.firstname = ?2</td></tr> <tr><td>Or</td> <td style="text-align:left;">findByLastnameOrFirstname</td> <td style="text-align:right;">… where x.lastname = ?1 or x.firstname = ?2</td></tr> <tr><td>Is,Equals</td> <td style="text-align:left;">findByFirstname,findByFirstnameIs,findByFirstnameEquals</td> <td style="text-align:right;">… where x.firstname = ?1</td></tr> <tr><td>Between</td> <td style="text-align:left;">findByStartDateBetween</td> <td style="text-align:right;">… where x.startDate between ?1 and ?2</td></tr> <tr><td>LessThan</td> <td style="text-align:left;">findByAgeLessThan</td> <td style="text-align:right;">… where x.age &lt; ?1</td></tr> <tr><td>LessThanEqual</td> <td style="text-align:left;">findByAgeLessThanEqual</td> <td style="text-align:right;">… where x.age &lt;= ?1</td></tr> <tr><td>GreaterThan</td> <td style="text-align:left;">findByAgeGreaterThan</td> <td style="text-align:right;">… where x.age &gt; ?1</td></tr> <tr><td>GreaterThanEqual</td> <td style="text-align:left;">findByAgeGreaterThanEqual</td> <td style="text-align:right;">… where x.age &gt;= ?1</td></tr> <tr><td>After</td> <td style="text-align:left;">findByStartDateAfter</td> <td style="text-align:right;">… where x.startDate &gt; ?1</td></tr> <tr><td>Before</td> <td style="text-align:left;">findByStartDateBefore</td> <td style="text-align:right;">… where x.startDate &lt; ?1</td></tr> <tr><td>IsNull</td> <td style="text-align:left;">findByAgeIsNull</td> <td style="text-align:right;">… where x.age is null</td></tr> <tr><td>IsNotNull,NotNull</td> <td style="text-align:left;">findByAge(Is)NotNull</td> <td style="text-align:right;">… where x.age not null</td></tr> <tr><td>Like</td> <td style="text-align:left;">findByFirstnameLike</td> <td style="text-align:right;">… where x.firstname like ?1</td></tr> <tr><td>NotLike</td> <td style="text-align:left;">findByFirstnameNotLike</td> <td style="text-align:right;">… where x.firstname not like ?1</td></tr> <tr><td>StartingWith</td> <td style="text-align:left;">findByFirstnameStartingWith</td> <td style="text-align:right;">… where x.firstname like ?1 (parameter bound with appended %)</td></tr> <tr><td>EndingWith</td> <td style="text-align:left;">findByFirstnameEndingWith</td> <td style="text-align:right;">… where x.firstname like ?1 (parameter bound with prepended %)</td></tr> <tr><td>Containing</td> <td style="text-align:left;">findByFirstnameContaining</td> <td style="text-align:right;">… where x.firstname like ?1 (parameter bound wrapped in %)</td></tr> <tr><td>OrderBy</td> <td style="text-align:left;">findByAgeOrderByLastnameDesc</td> <td style="text-align:right;">… where x.age = ?1 order by x.lastname desc</td></tr> <tr><td>Not</td> <td style="text-align:left;">findByLastnameNot</td> <td style="text-align:right;">… where x.lastname &lt;&gt; ?1</td></tr> <tr><td>In</td> <td style="text-align:left;">findByAgeIn(Collection&lt;Age&gt; ages)</td> <td style="text-align:right;">… where x.age in ?1</td></tr> <tr><td>NotIn</td> <td style="text-align:left;">findByAgeNotIn(Collection&lt;Age&gt; ages)</td> <td style="text-align:right;">… where x.age not in ?1</td></tr> <tr><td>True</td> <td style="text-align:left;">findByActiveTrue()</td> <td style="text-align:right;">… where x.active = true</td></tr> <tr><td>False</td> <td style="text-align:left;">findByActiveFalse()</td> <td style="text-align:right;">… where x.active = false</td></tr> <tr><td>IgnoreCase</td> <td style="text-align:left;">findByFirstnameIgnoreCase</td> <td style="text-align:right;">… where UPPER(x.firstame) = UPPER(?1)</td></tr></tbody></table> <h3 id="使用举例-2"><a href="#使用举例-2" aria-hidden="true" class="header-anchor">#</a> 使用举例</h3> <div class="language- extra-class"><pre class="language-text"><code>public interface UserRepository extends Repository&amp;lt;User, Long&amp;gt; {
	
	User findByUsername(String username);
}
</code></pre></div><h3 id="通过specifications生产复杂查询"><a href="#通过specifications生产复杂查询" aria-hidden="true" class="header-anchor">#</a> 通过Specifications生产复杂查询</h3> <p>通过方法名自动生成查询虽然是一个便利的方法，但是如果查询条件复杂的话，整个方法就会特别的复杂，这个时候就需要使用Specifications生产复杂查询。<br>
Specifications实现步骤如下：</p> <ol><li>继承JpaSpecificationExecutor接口</li> <li>创建Specification实现类，构建查询条件<br>
Specifications能够支持复杂查询就在于Specification接口，本节将会重点讲解这部分。</li></ol> <div class="language- extra-class"><pre class="language-text"><code>public interface Specification&amp;lt;T&amp;gt; extends Serializable {

	static &amp;lt;T&amp;gt; Specification&amp;lt;T&amp;gt; not(Specification&amp;lt;T&amp;gt; spec) {
		return Specifications.negated(spec);
	}

	static &amp;lt;T&amp;gt; Specification&amp;lt;T&amp;gt; where(Specification&amp;lt;T&amp;gt; spec) {
		return Specifications.where(spec);
	}

	default Specification&amp;lt;T&amp;gt; and(Specification&amp;lt;T&amp;gt; other) {
		return Specifications.composed(this, other, AND);
	}

	default Specification&amp;lt;T&amp;gt; or(Specification&amp;lt;T&amp;gt; other) {
		return Specifications.composed(this, other, OR);
	}

	@Nullable
	Predicate toPredicate(Root&amp;lt;T&amp;gt; root, CriteriaQuery&amp;lt;?&amp;gt; query, CriteriaBuilder criteriaBuilder);
}
</code></pre></div><p>上面是Specification接口的代码描述，Specification有五个方法下面我们将会讲解每个方法的作用以及使用场景。</p> <ul><li>static &lt;T&gt; Specification&lt;T&gt; not(Specification&lt;T&gt; spec)<br>
不满足spec参数指定的条件构建，类似于！=spec的作用，使用示例如下</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Specification&lt;Object&gt; specification = Specification
				.not(serializableSpec.and(serializableSpec).or(serializableSpec));
</code></pre></div><ul><li>static &lt;T&gt; Specification&lt;T&gt; where(Specification&lt;T&gt; spec)
提供了一个创建Specification对象的工厂方法</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Specification&lt;Object&gt; specification = Specification.where(null);;
</code></pre></div><ul><li>default Specification&lt;T&gt; and(Specification&lt;T&gt; other)<br>
将other条件添加到当前对象中，是一个与关系，两个条件都要满足。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Specification&lt;Object&gt; specification = where(null);
		specification = specification.and(spec);
</code></pre></div><ul><li>default Specification&lt;T&gt; or(Specification&lt;T&gt; other)<br>
将other条件添加到当前对象中，是一个或关系，两个条件满足一个就可以。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Specification&lt;Object&gt; specification = where(null);
		specification = specification.or(spec);
</code></pre></div><ul><li>Predicate toPredicate(Root&lt;T&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder criteriaBuilder)<br>
使用root和query构建查询条件</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Specification&lt;Object&gt; specification = where(null);
		specification = specification.or(spec);
</code></pre></div><ol><li>使用步骤2.构建的条件，进行复杂查询</li></ol> <h3 id="使用举例-3"><a href="#使用举例-3" aria-hidden="true" class="header-anchor">#</a> 使用举例</h3> <ul><li>继承JpaSpecificationExecutor接口</li></ul> <div class="language- extra-class"><pre class="language-text"><code>public interface UserRepository extends Repository&amp;lt;User, Long&amp;gt;, JpaSpecificationExecutor&amp;lt;User&amp;gt; {
	
}
</code></pre></div><ul><li>创建Specification实现类，构建查询条件</li></ul> <div class="language- extra-class"><pre class="language-text"><code>public class UserSpec implements Specification&amp;lt;User&amp;gt; {
	
	private static final long serialVersionUID = 1L;
	
	/**
	 * 条件
	 */
	@Builder.Default
	private Optional&amp;lt;UserVo&amp;gt; condition = Optional.empty();

	@Override
	public Predicate toPredicate(Root&amp;lt;User&amp;gt; root, CriteriaQuery&amp;lt;?&amp;gt; query, CriteriaBuilder criteriaBuilder) {
		List&amp;lt;Predicate&amp;gt; predicates = new ArrayList&amp;lt;Predicate&amp;gt;();
		if(condition.isPresent()) {
			if(!StringUtil.isNullOrEmpty(condition.get().getUsername())) {
				predicates.add(criteriaBuilder.equal(root.get(&quot;username&quot;), condition.get().getUsername()));
			}
			if(!StringUtil.isNullOrEmpty(condition.get().getPassword())) {
				predicates.add(criteriaBuilder.equal(root.get(&quot;password&quot;), condition.get().getPassword()));
			}
			if(!StringUtil.isNullOrEmpty(condition.get().getToken())) {
				predicates.add(criteriaBuilder.equal(root.get(&quot;token&quot;), condition.get().getToken()));
			}
			return criteriaBuilder.and(predicates.toArray(new Predicate[predicates.size()]));
		}else {
			return null;
		}
	}

}
</code></pre></div><ul><li>复杂查询</li></ul> <div class="language- extra-class"><pre class="language-text"><code>public UserVo findUser(String name, String password) {
    Optional&amp;lt;UserVo&amp;gt; condition = Optional.ofNullable(UserVo.builder().username(name).password(password).build());
    Optional&amp;lt;User&amp;gt; user = userRepository.findOne(UserSpec.builder().condition(condition).build());
    if (!user.isPresent()) {
        return null;
    }
    UserVo target = new UserVo();
    BeanUtils.copyProperties(user.get(), target);
    return target;
}
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/yogurtcat/assets/js/app.4215de08.js" defer></script><script src="/yogurtcat/assets/js/2.557ba043.js" defer></script><script src="/yogurtcat/assets/js/34.e8875b32.js" defer></script>
  </body>
</html>
